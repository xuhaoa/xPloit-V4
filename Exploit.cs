using System;
using System.IO;

namespace xPloit_V4
{

    class Exploit
    {
        OS os = new OS();
        FileManager fileLib = new FileManager();

        //CMD Bypass:
        public void createCMDBypass()
        {
            string drive = os.getCurrentDrive();
            string user = os.getUser();
            string desktop = drive + "Users\\" + user + "\\Desktop";
            string fullPath = desktop + "\\cmdbypass.cmd";

            fileLib.createFile(fullPath);
            StreamWriter sw = new StreamWriter(fullPath);

            sw.WriteLine("@echo off\n");
            sw.WriteLine("title xPloit V4 CMD Bypass\n");
            sw.WriteLine("goto getcommand\n");
            sw.WriteLine(":getcommand\n");
            sw.WriteLine("set /p command=Hacker: \n");
            sw.WriteLine("%command%\n");
            sw.WriteLine("goto getcommand\n");
            sw.Dispose();
        }

        //Remote Shutdown:
        public void remoteShutdown()
        {
            string drive = os.getCurrentDrive();
            string user = os.getUser();
            string desktop = drive + "Users\\" + user + "\\Desktop";
            string fullPath = desktop + "\\shutdown.cmd";

            fileLib.createFile(fullPath);
            StreamWriter sw = new StreamWriter(fullPath);

            sw.WriteLine("shutdown -i");
            sw.Dispose();
        }
    }
}